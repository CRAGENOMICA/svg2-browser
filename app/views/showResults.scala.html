@(
experimentID: String,
colorSVG: String,
colorBarplot: String,
formulario: play.data.Form[ExperimentForm],
niceColors: Seq[ String ],
listTissue: Seq[ String ],
filteredGeneList: Seq[ String ],
)(implicit request: play.mvc.Http.Request, messages: play.i18n.Messages)

@import play.mvc.Http.Request
@import helper._

@main("SVG2 Browser") {
@header()


<div class="container">
	  <div class="row">
	  
	    <!-- SVG, download and change color-->
	    <div class="col-sm-6">
	      <h1>SVG</h1>
	      <div id="imagen_svg" class="output_svg">
		      <img src="/getImageSVG/@experimentID/@colorSVG" class="img-fluid" />
		  </div>
	      <div id="download_svg">
	          <a href="/getImageSVG/@experimentID/@colorSVG" download>Download as png</a>
	      </div>
		   
	      @helper.form(action = routes.SVG2Browser.updateOutputExperiment()) {
		    @CSRF.formField
			
			@select(
		      formulario("colorSVG"),
		      options = niceColors.map( color => color -> color  ),
		      '_label -> "Select an alternative color", 
		      '_default -> "-- change Color --"
		     
		     )
		
		  }
	        
	    </div>
	    
	     <!--  barplot + filtered genes -->
	     <div class="col-sm-6">
	     <h1>Barplot</h1>
	        <div id="image_barplot" class="output_barplot">
		      	<img src="/getImageBarplot/@experimentID/@colorBarplot" class="img-fluid" />
		    </div>
	        <div id="download_barplot">
	        	<a href="/getImageBarplot/@experimentID/@colorBarplot" download>Download as png</a>
	        </div>
	      
	        @helper.form(action = routes.SVG2Browser.updateOutputExperiment()) {
		      @CSRF.formField
			
			  @select(
		        formulario("colorBarplot"),
		        options = niceColors.map( color => color -> color  ),
		        '_label -> "Select an alternative color", 
		        '_default -> "-- change Color --"
		         
		      )
		
		    }
		    
		    @helper.form(action = routes.SVG2Browser.updateOutputExperiment()) {
		      @CSRF.formField
			
			  @select(
		        formulario("selectedTissue"),
		        options = listTissue.map( tissue => tissue -> tissue  ),
		        '_label -> "Show genes in tissues...", '_default -> "-- select tissue --"
		      )			   
		    }
		    
		    <textarea id="tissue_genes" rows="4" cols="50">
				En un lugar de la mancha, donde Ariel no paseaba, pues no hab√≠a mares, ... 
			</textarea>
	    </div> 
	  
	  </div>
</div>

<script>

  $("#colorSVG").on('change', function() {

	var expId = '@Html(experimentID)';	
	var newColorSVG = $(this).find('option:selected').text();
	
	var svgurl = '<img src=\"/getImageSVG/' + expId + '/' + newColorSVG + '\" class=\"img-fluid\"/>'	              
    console.log( 'SVG_URL: ' + svgurl);
	$("#imagen_svg").html( svgurl );
	
	
	var svgdownload = '<a href=\"/getImageSVG/' + expId + '/' + newColorSVG + '\" download>Download as png</a>'	              
    console.log( 'SVG_DL: ' + svgdownload);
	$("#download_svg").html( svgdownload );
	
  });


  $("#colorBarplot").on('change', function() {

	var expId = '@Html(experimentID)';
	var newColorBarplot = $(this).find('option:selected').text();
	
	var barploturl = '<img src=\"/getImageBarplot/' + expId + '/' + newColorBarplot + '\" class=\"img-fluid\"/>'	              
    console.log( 'BAR_URL: ' + barploturl);
	$("#image_barplot").html( barploturl );
	
	
	var barplotdownload = '<a href=\"/getImageBarplot/' + expId + '/' + newColorBarplot + '\" download>Download as png</a>'	              
    console.log( 'BAT_DL: ' + barplotdownload);
	$("#download_barplot").html( barplotdownload );
	
  });

  $("#selectedTissue").on('change', function() {

	var expId = '@Html(experimentID)';
	var tissue = $(this).find('option:selected').text();
	
	
	$.getJSON( '/getGenesFromTissue/' + expId + '/' + tissue, function( genesJSON ) {
      	console.log( 'Genes: ' + genesJSON);
      	$("#tissue_genes").html("");
    	
      	$.each(genesJSON, function(i, field){
	      
	      $("#tissue_genes").append( field + "\n" );
	    });
    
      });
	
	
  });

</script>


}